<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="report_invoice_document_fp_electronic_header" inherit_id="account.report_invoice_document">
        <xpath expr="//t[@t-set='layout_document_title']" position="after">
            <t t-if="o.fp_is_electronic_invoice">
                <t t-set="layout_document_title">
                    <t t-set="fp_document_types" t-value="{
                        'FE': 'Factura Electrónica',
                        'TE': 'Tiquete Electrónico',
                        'FEC': 'Factura Electrónica de Compra',
                        'NC': 'Nota de Crédito Electrónica',
                        'ND': 'Nota de Débito Electrónica',
                        'CCE': 'Confirmación de Aceptación',
                        'CPCE': 'Confirmación Parcial de Aceptación',
                        'RCE': 'Confirmación de Rechazo'
                    }"/>
                    <span t-esc="fp_document_types.get(o.fp_document_type, 'Comprobante Electrónico')"/>
                    <span t-if="o.name and o.name != '/'" t-field="o.name"/>
                </t>
            </t>
        </xpath>

        <xpath expr="//div[@id='informations']" position="before">
            <t t-if="o.fp_is_electronic_invoice">
                <div class="mt-2 mb-2">
                    <div>
                        <strong>Consecutivo:</strong>
                        <span t-field="o.fp_consecutive_number"/>
                    </div>
                    <div>
                        <strong>Clave:</strong>
                        <span t-field="o.fp_external_id"/>
                    </div>
                </div>
            </t>
        </xpath>



        <xpath expr="//*[@t-field='o.partner_id' and contains(@t-options, '&quot;widget&quot;: &quot;contact&quot;')][1]" position="replace">
            <t t-if="o.partner_id.country_id.code == 'CR'">
                <div>
                    <strong>Provincia:</strong>
                    <span t-esc="o.partner_id.state_id.name or ''"/>
                </div>
                <div>
                    <strong>Cantón:</strong>
                    <span t-esc="o.partner_id.city or ''"/>
                </div>
                <div>
                    <strong>Distrito:</strong>
                    <span t-esc="o.partner_id.fp_district_code or ''"/>
                </div>
                <div>
                    <strong>Barrio:</strong>
                    <span t-esc="o.partner_id.fp_neighborhood_code or ''"/>
                </div>
                <div t-if="o.partner_id.street">
                    <strong>OtrasSenas:</strong>
                    <span t-esc="o.partner_id.street"/>
                </div>
            </t>
            <div t-else="" t-field="o.partner_id" t-options='{"widget": "contact", "fields": ["address", "name"], "no_marker": True}'/>
        </xpath>

        <xpath expr="//div[contains(@class, 'page')]" position="inside">
            <t t-if="o.fp_is_electronic_invoice">
                <div class="mt-4 text-muted" style="font-size: 11px;">
                    Emitida conforme lo establecido en la resolución de Facturación Electrónica,
                    MH-DGT-RES-0027-2024 del 19 de noviembre de 2024 de la Dirección General de Tributación Directa.
                </div>
            </t>
        </xpath>
    </template>
</odoo>
